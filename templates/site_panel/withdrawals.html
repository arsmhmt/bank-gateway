{% extends "site_panel/base.html" %}

{% block site_content %}
<div class="container-fluid px-0 px-md-1">
  <div class="panel-header">
    <h1>{{ branch.name }} - Çekimler</h1>
    <p>Tüm çekim işlemlerinizi buradan görüntüleyebilirsiniz.</p>
  </div>

  <div class="card table-card mb-3">
    <form method="get" class="row g-3 mb-3">
      <div class="col-md-3">
        <label class="form-label" for="start_date">Başlangıç Tarihi</label>
        <input type="date" id="start_date" name="start_date" class="form-control" value="{{ filters.start_date }}">
      </div>
      <div class="col-md-3">
        <label class="form-label" for="end_date">Bitiş Tarihi</label>
        <input type="date" id="end_date" name="end_date" class="form-control" value="{{ filters.end_date }}">
      </div>
      <div class="col-md-3">
        <label class="form-label" for="status">Durum</label>
        <select id="status" name="status" class="form-select">
          <option value="">Tümü</option>
          {% for value,label in status_choices %}
          <option value="{{ value }}" {% if filters.status == value %}selected{% endif %}>{{ label }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="col-md-3 d-flex align-items-end">
        <button type="submit" class="btn btn-primary w-100">Filtrele</button>
      </div>
    </form>

    <div class="card table-card">
    <div class="table-responsive">
      <table class="data-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Zaman</th>
            <th>Kullanıcı</th>
            <th>Tutar</th>
            <th>IBAN</th>
            <th>Durum</th>
          </tr>
        </thead>
        <tbody>
        {% for w in withdrawals %}
          <tr>
            <td>#{{ w.id }}</td>
            <td>{{ w.created_at|date:"d.m.Y H:i:s" }}</td>
            <td>{{ w.user_name }}</td>
            <td><strong>{{ w.amount|floatformat:2 }} TRY</strong></td>
            <td><code>{{ w.iban }}</code></td>
            <td>
              <span class="status-badge status-{{ w.status }}">
                {{ w.get_status_display }}
              </span>
            </td>
          </tr>
        {% empty %}
          <tr><td colspan="7" class="text-center">Henüz çekim kaydı yok.</td></tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <div class="navigation-links">
    <a href="{% url 'site_panel:dashboard' %}" class="btn btn-secondary">← Panele Dön</a>
  </div>

<style>
.panel-header {
  margin-bottom: 2rem;
}

.panel-header h1 {
  font-size: 2rem;
  color: #1a1a1a;
  margin-bottom: 0.5rem;
}

.panel-header p {
  color: #666;
}

.table-card {
  padding: 1.5rem;
  margin-bottom: 2rem;
}

.table-responsive {
  overflow-x: auto;
}

.data-table {
  width: 100%;
  border-collapse: collapse;
}

.data-table th,
.data-table td {
  padding: 0.75rem;
  text-align: left;
  border-bottom: 1px solid #eee;
}

.data-table th {
  background: #f8f9fa;
  font-weight: 600;
  color: #495057;
  white-space: nowrap;
}

.data-table tbody tr:hover {
  background: #f8f9fa;
}

.data-table code {
  background: #f8f9fa;
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
  font-family: 'Courier New', monospace;
  font-size: 0.875rem;
}

.text-center {
  text-align: center;
}

.status-badge {
  padding: 0.25rem 0.75rem;
  border-radius: 20px;
  font-size: 0.875rem;
  font-weight: 500;
  white-space: nowrap;
}

.status-pending {
  background: #fff3cd;
  color: #856404;
}

.status-approved {
  background: #d4edda;
  color: #155724;
}

.status-rejected {
  background: #f8d7da;
  color: #721c24;
}

.navigation-links {
  display: flex;
  gap: 1rem;
}

.btn-secondary {
  display: inline-block;
  padding: 0.75rem 1.5rem;
  background: #6c757d;
  color: white;
  text-decoration: none;
  border-radius: 8px;
  font-weight: 500;
  transition: background 0.3s;
}

.btn-secondary:hover {
  background: #5a6268;
}
</style>
{% endblock %}
